<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link type="text/css" rel="stylesheet" href="fichier_CSS.css">
        <title>Proact'IF inscription</title>
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

    </head>
    <body>
        <header>
            <center>
                <img alt="logo" src="images/logo.PNG">

            </center>
        </header>

        <fieldset class="formulaire_inscription">
            <legend align="left"> Inscription: </legend>
            <div id="message">

            </div>
            <input type="radio" id="Choice1"
                   name="civilite" value="Monsieur" checked="checked">
            <label for="Choice1">Monsieur</label>

            <input type="radio" id="Choice2"
                   name="civilite" value="Madame">
            <label for="Choice2">Madame</label>

            <!-- <label for="Civilite"> Civilité </label><input type="text" id="Civilite" /><br>-->
            <label for="Nom" >Nom   </label>         <input type="text" id="Nom"    /><br>
            <label for="Prenom">Prenom   </label>         <input type="text" id="Prenom"  /><br>
            <label for="Telephone">    Telephone </label>  <input type="text" id="Telephone" /><br>
            <label for="adresseMail">    Adresse mail </label>  <input type="text" id="adresseMail" /><br>
            <label for="DatedeNaissance"> Date de naissance </label> <input type="date" id="DatedeNaissance"  /> <img alt='carte' src='images/calendrier.PNG' width='30'><br>
            <label for="Ville">Ville</label> <input type="text" id="Ville" /><br>
            <label for=CodePostal>Code Postal</label> <input type="text" id="CodePostal"  /><br>
            <label for=RueEtNumero>Rue et numéro </label><input type="text" id="RueEtNumero" /><br>
            <label for=ComplementAdresse>Complement d'adresse</label> <input type="text" id="ComplementAdresse" /><br>
            <label for=MotPasse> Mot de passe</label> <input type="password" id="MotPasse"  /><br>
            <label for="ConfirmationMotdePasse"> Confirmation du mot de passe</label> <input type="password" id="ConfirmationMotdePasse" /><br>
            <br>
            <label for="conditions">J'ai lu et j'accepte les conditions Générales de vente</label>  <input type="radio" id="conditions" name="conditions" value="conditions">
            <br>

            <br><br>
            <label for="robot">Je ne suis pas un robot</label>
            <input type="radio" id="robot" name="robot" value="robot" >


            <br><br>

            <center><button  id="bouton-inscription"  >valider l'inscription</button> </center>


        </fieldset>

        <script>
            function checkparam(Champnom, ChampPrenom, ChampTelephone, ChampadresseMail, ChampDatedeNaissance, ChampVille, ChampCodePostal, ChampRueEtNumero, ChampComplementAdresse, ChampMotPasse, ChampConfirmationMotdePasse, ChampConditions, ChampRobot) {

                var validate = true;
                var elem;
                if (Champnom === "") {
                    elem = document.getElementById('Nom');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampPrenom === "") {
                    elem = document.getElementById('Prenom');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampTelephone === "") {
                    elem = document.getElementById('Telephone');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampadresseMail === "") {
                    elem = document.getElementById('adresseMail');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampDatedeNaissance === "") {
                    elem = document.getElementById('DatedeNaissance');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampVille === "") {
                    elem = document.getElementById('Ville');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampCodePostal === "") {
                    elem = document.getElementById('CodePostal');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampVille === "") {
                    elem = document.getElementById('Ville');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampRueEtNumero === "") {
                    elem = document.getElementById('RueEtNumero');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }


                if (ChampMotPasse === "") {
                    elem = document.getElementById('MotPasse');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampConfirmationMotdePasse === "") {
                    elem = document.getElementById('ConfirmationMotdePasse');
                    elem.setAttribute("style", " border-color:red");
                    validate = false;
                }
                if (ChampMotPasse !== ChampConfirmationMotdePasse)
                {
                    elem = document.getElementById('MotPasse');
                    elem.setAttribute("style", " border-color:red");
                    elem = document.getElementById('ConfirmationMotdePasse');
                    elem.setAttribute("style", " border-color:red");
                    $('#message').html('<div style="color:red;" align="center" >Veuillez saisir le même mot de passe</div>');
                    validate = false;
                }


                if (ChampConditions !== "conditions") {

                    elem = document.getElementById('conditions');
                    elem.setAttribute("style", " border-color:red");
                    $('#message').html('<div style="color:red;" align="center" >Veuillez accepter les conditions Générales de vente</div>');
                    validate = false;

                }

                if (ChampRobot !== "robot") {

                    elem = document.getElementById('robot');
                    elem.setAttribute("style", " border-color:red");
                    $('#message').html('<div style="color:red;" align="center" >Veuillez cocher la case je suis pas un robot</div>');
                    validate = false;

                }

                return validate;


            }

            function register(Champcivilite, Champnom, ChampPrenom, ChampTelephone, ChampadresseMail, ChampDatedeNaissance, ChampVille, ChampCodePostal, ChampRueEtNumero, ChampComplementAdresse, ChampMotPasse) {
                
                $('#message').html('Inscription en cours...');
                $.ajax({
                    url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'register',
                        civilite: Champcivilite,
                        nom: Champnom,
                        prenom: ChampPrenom,
                        telephone: ChampTelephone,
                        adresseMail: ChampadresseMail,
                        DatedeNaissance: ChampDatedeNaissance,
                        Ville: ChampVille,
                        CodePostal: ChampCodePostal,
                        RueEtNumero: ChampRueEtNumero,
                        ComplementAdresse: ChampComplementAdresse,
                        MotPasse: ChampMotPasse

                    },
                    dataType: 'json'


                }).done(function (data) {
                    var bool = data.valueOf();

                    var inscription;
                    if (bool) {
                        inscription = "success";
                        document.location.href = 'login.html?Register=' + inscription;


                    } else {
                        
                        inscription = "failed";
                        document.location.href = 'login.html?Register=' + inscription;
                       
                    }
                });
            }

            $(document).ready(function () {

                $('#bouton-inscription').on('click', function () {
                    $('#message').html('');
                    var Element;
                    var Champnom = $('#Nom').val();
                    Element = document.getElementById('Nom');
                    Element.setAttribute("style", "");

                    var ChampPrenom = $('#Prenom').val();
                    Element = document.getElementById('Prenom');
                    Element.setAttribute("style", "");

                    var ChampTelephone = $('#Telephone').val();
                    Element = document.getElementById('Telephone');
                    Element.setAttribute("style", "");

                    var ChampadresseMail = $('#adresseMail').val();
                    Element = document.getElementById('adresseMail');
                    Element.setAttribute("style", "");

                    var ChampDatedeNaissance = $('#DatedeNaissance').val();
                    Element = document.getElementById('DatedeNaissance');
                    Element.setAttribute("style", "");

                    var ChampVille = $('#Ville').val();
                    Element = document.getElementById('Ville');
                    Element.setAttribute("style", "");

                    var ChampCodePostal = $('#CodePostal').val();
                    Element = document.getElementById('CodePostal');
                    Element.setAttribute("style", "");

                    var ChampRueEtNumero = $('#RueEtNumero').val();
                    Element = document.getElementById('RueEtNumero');
                    Element.setAttribute("style", "");

                    var ChampComplementAdresse = $('#ComplementAdresse').val();
              

                    var ChampMotPasse = $('#MotPasse').val();
                    Element = document.getElementById('MotPasse');
                    Element.setAttribute("style", "");

                    var ChampConfirmationMotdePasse = $('#ConfirmationMotdePasse').val();
                    Element = document.getElementById('ConfirmationMotdePasse');
                    Element.setAttribute("style", "");

                    var ChampConditions = $('input[name=conditions]:checked').val();

                    var ChampRobot = $('input[name=robot]:checked').val();


                    validate = checkparam(Champnom, ChampPrenom, ChampTelephone, ChampadresseMail, ChampDatedeNaissance, ChampVille, ChampCodePostal, ChampRueEtNumero, ChampComplementAdresse, ChampMotPasse, ChampConfirmationMotdePasse, ChampConditions, ChampRobot);
                 

                    if (validate) {
                        var Champcivilite = $('input[name=civilite]:checked').val();
                        if (Champcivilite === 'Monsieur') {
                            Champcivilite = 'H';
                        } else {
                            Champcivilite = 'F';
                        }

                        register(Champcivilite, Champnom, ChampPrenom, ChampTelephone, ChampadresseMail, ChampDatedeNaissance, ChampVille, ChampCodePostal, ChampRueEtNumero, ChampComplementAdresse, ChampMotPasse);
                    }
                });
            });

        </script>
        <footer>
            <ul id="menu_horizontal">
                <li><a href="index.html">Accueil</a></li>
                <li><a href="forum.html">A propos de Proact'IF</a></li>
                <li><a href="contact.html">Mentions légales</a></li>
                <li><a href="contact.html">CGV</a></li>
            </ul>
        </footer>
    </body>
</html>